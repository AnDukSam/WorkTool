<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ïπ¥ÌÜ° ÌñâÏÇ¨</title>
    <style>
        * { box-sizing: border-box; }
        body { padding: 0 15px 40px 15px; margin: 0; font-family: 'Malgun Gothic', sans-serif; background-color: #f5f5f5; }
        .main-title { text-align: center; padding: 20px 0; margin: 0 -15px 20px -15px; background: linear-gradient(135deg, #4CAF50, #2E7D32); color: white; font-size: 20px; font-weight: bold; box-shadow: 0 2px 10px rgba(0,0,0,0.1); letter-spacing: 1px; }
        .date-controller { display: flex; align-items: center; justify-content: center; gap: 12px; background: #fff; padding: 15px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .date-controller label { font-weight: bold; font-size: 15px; margin-right: 10px; }
        .date-btn { width: 40px; height: 40px; font-size: 20px; background-color: #eee; border: 1px solid #ddd; border-radius: 8px; cursor: pointer; }
        #dateInput { width: 60px; height: 40px; text-align: center; font-size: 18px; border: 1px solid #ddd; border-radius: 8px; }
        #container { display: flex; flex-direction: column; gap: 12px; margin-bottom: 25px; }
        .header { display: flex; gap: 10px; margin-bottom: 20px; }
        .header button { flex: 1; height: 50px; font-size: 16px; border-radius: 10px; border: none; font-weight: bold; }
        #plusBtn { background-color: #4CAF50; color: white; }
        #extractBtn { background-color: #2196F3; color: white; }
        .row { background-color: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); display: flex; flex-wrap: wrap; gap: 8px; position: relative; }
        .row-number { font-weight: bold; color: #4CAF50; width: 100%; font-size: 14px; margin-bottom: 5px; }
        select, input { height: 45px; padding: 8px; border: 1px solid #ddd; border-radius: 6px; font-size: 15px; }
        .product-select { width: 100%; }
        .unit-select { flex: 1; min-width: 85px; }
        .normal-price, .sale-price { flex: 1; min-width: 95px; }
        .del-btn { position: absolute; top: 10px; right: 10px; background-color: #ff5252; color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; }
        #resultArea { margin-top: 20px; padding: 15px; background-color: #fff; border: 2px dashed #4CAF50; border-radius: 10px; white-space: pre-wrap; font-size: 14px; display: none; }
        #copyBtn { background-color: #333; color: white; margin-top: 15px; width: 100%; height: 55px; display: none; border: none; border-radius: 10px; font-size: 17px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="main-title">Ïπ¥ÌÜ° ÌñâÏÇ¨</div>

    <div class="date-controller">
        <label>ÌñâÏÇ¨ Í∏∞Í∞Ñ</label>
        <button class="date-btn" id="dateMinus">-</button>
        <input type="number" id="dateInput" value="1" min="1">
        <button class="date-btn" id="datePlus">+</button>
        <span>ÏùºÍ∞Ñ</span>
    </div>

    <div id="container"></div>

    <div class="header">
        <button id="plusBtn">ÏÉÅÌíà Ï∂îÍ∞Ä</button>
        <button id="extractBtn">ÌÖçÏä§Ìä∏ Ï∂îÏ∂ú</button>
    </div>

    <div id="resultArea"></div>
    <button id="copyBtn">üìã ÌÖçÏä§Ìä∏ Î≥µÏÇ¨</button>

    <script>
        const container = document.getElementById('container');
        const plusBtn = document.getElementById('plusBtn');
        const extractBtn = document.getElementById('extractBtn');
        const copyBtn = document.getElementById('copyBtn');
        const resultArea = document.getElementById('resultArea');
        const dateInput = document.getElementById('dateInput');

        document.getElementById('dateMinus').onclick = () => { if (dateInput.value > 1) dateInput.value = parseInt(dateInput.value) - 1; };
        document.getElementById('datePlus').onclick = () => { dateInput.value = parseInt(dateInput.value) + 1; };

        // 'ÌïúÏö∞ ÏÜåÎ∂àÍ≥†Í∏∞' Î∞è 'ÌïúÏö∞ Î∂àÍ≥†Í∏∞'Í∞Ä Î™®Îëê Ï†úÍ±∞Îêú Î¶¨Ïä§Ìä∏ÏûÖÎãàÎã§.
        const productList = [
            "ÌïúÏö∞ Í≥∞ÌÉï", "ÌïúÏö∞ Íµ≠Í±∞Î¶¨", "ÌïúÏö∞ ÍΩÉÎì±Ïã¨", "ÌïúÏö∞ Î∂àÍ≥†Í∏∞Ïö©", "ÌïúÏö∞ Ïú°Ìöå", "ÌïúÏö∞ Ïú°Ìöå(ÏÜåÏä§ Ìè¨Ìï®)", "ÌïúÏö∞ Ï±ÑÎÅùÎì±Ïã¨",
            "----------",
            "1+ ÌïúÏö∞ Íµ≠Í±∞Î¶¨", "1+ ÌïúÏö∞ ÍΩÉÎì±Ïã¨", "1+ ÌïúÏö∞ Ïú°Ìöå", "1+ ÌïúÏö∞ Ïú°Ìöå(ÏÜåÏä§ Ìè¨Ìï®)", "1+ ÌïúÏö∞ Ï±ÑÎÅùÎì±Ïã¨",
            "----------",
            "ÌïúÎèà Í∞àÎπÑ", "ÌïúÎèà Îì±Í∞àÎπÑ", "ÌïúÎèà Îì±Îºà", "ÌïúÎèà Î™©ÏÇ¥", "ÌïúÎèà ÏÇ¨ÌÉú", "ÌïúÎèà ÏÇºÍ≤πÏÇ¥", "ÌïúÎèà ÏïûÎã§Î¶¨ÏÇ¥(ÏàòÏú°Ïö©)",
            "----------",
            "ÎåÄÌå®ÏÇºÍ≤πÏÇ¥(Íµ≠ÎÇ¥ÏÇ∞)", "ÎåÄÌå®ÏÇºÍ≤πÏÇ¥(ÏàòÏûÖÏÇ∞)", "ÎåÄÌå®ÏÇºÍ≤πÏÇ¥(Ïπ†Î†àÏÇ∞)", "Ïö∞ÏÇºÍ≤π",
            "----------",
            "ÏñëÎÖê ÎèºÏßÄÍ∞àÎπÑ", "Î∂ÅÏÑ±Î°ú Î∂àÍ≥†Í∏∞", "ÎºàÏóÜÎäî Îã≠Í∞àÎπÑ", "Í≥†Ï∂îÏû• Î∂àÍ≥†Í∏∞", "ÏñëÎÖê ÏÜåÎ∂àÍ≥†Í∏∞", "ÏñëÎÖê LAÍ∞àÎπÑ", "LAÍ∞àÎπÑÏãù ÏñëÎÖê ÎèºÏßÄÍ∞àÎπÑ", "Îã§Ìñ• ÌõàÏ†úÏò§Î¶¨", "Îã≠Î∞ú Ìé∏Ïú°", "Î¨¥Îºà ÏñëÎÖêÎã≠Î∞ú", "ÌùëÎßàÎäò Ïò§Î¶¨ÌõàÏ†ú", "ÌïòÎ¶º ÏÉùÎã≠(11Ìò∏)", "ÌïòÎ¶º ÏÉùÎã≠(13Ìò∏)", "ÌïòÎ¶º ÏòÅÍ≥Ñ", "ÌïòÎ¶º ÌÜ†Ï¢ÖÎã≠"
        ];

        const unitList = ['100g', '1Ìå©', '1Î¥â(600g Ïù¥ÏÉÅ)', '1ÌÜµ', '1ÎßàÎ¶¨', '2ÎßàÎ¶¨'];

        plusBtn.onclick = () => {
            const row = document.createElement('div');
            row.className = 'row';
            const currentSelectedItems = Array.from(container.querySelectorAll('.product-select')).map(s => s.value);
            let lastIdx = -1;
            if (currentSelectedItems.length > 0) { lastIdx = productList.indexOf(currentSelectedItems[currentSelectedItems.length - 1]); }
            let nextIdx = (lastIdx + 1) % productList.length;
            while (productList[nextIdx] === "----------") { nextIdx = (nextIdx + 1) % productList.length; }

            const num = container.children.length + 1;
            row.innerHTML = `
                <div class="row-number">ÌíàÎ™© ${num}</div>
                <button class="del-btn">ÏÇ≠Ï†ú</button>
                <select class="product-select">
                    ${productList.map((item, idx) => `<option value="${item}" ${item.includes('---') ? 'disabled' : ''} ${idx === nextIdx ? 'selected' : ''}>${item}</option>`).join('')}
                </select>
                <select class="unit-select">
                    ${unitList.map(u => `<option value="${u}">${u}</option>`).join('')}
                </select>
                <input type="number" class="normal-price" placeholder="Ï†ïÏÉÅÍ∞Ä">
                <input type="number" class="sale-price" placeholder="ÌåêÎß§Í∞Ä">
            `;
            const selectEl = row.querySelector('.product-select');
            let previousValue = selectEl.value;
            selectEl.onfocus = (e) => { previousValue = e.target.value; };
            selectEl.onchange = (e) => {
                const otherSelects = Array.from(container.querySelectorAll('.product-select')).filter(s => s !== selectEl);
                if (otherSelects.some(s => s.value === e.target.value)) { alert("Ïù¥ÎØ∏ ÏÑ†ÌÉùÎêú ÏÉÅÌíàÏûÖÎãàÎã§."); e.target.value = previousValue; }
                else { previousValue = e.target.value; }
            };
            row.querySelector('.del-btn').onclick = () => { row.remove(); updateNumbers(); };
            container.appendChild(row);
        };

        window.onload = () => { plusBtn.click(); };
        function updateNumbers() { container.querySelectorAll('.row-number').forEach((el, idx) => el.textContent = `ÌíàÎ™© ${idx + 1}`); }

        function getEventDateText(days) {
            const week = ['Ïùº', 'Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†'];
            const start = new Date();
            const end = new Date();
            end.setDate(start.getDate() + (days - 1));
            const startYear = start.getFullYear();
            const startMonth = start.getMonth() + 1;
            const startDate = start.getDate();
            const startDay = week[start.getDay()];
            let dayString = "";
            for(let i=0; i<days; i++) {
                let d = new Date();
                d.setDate(start.getDate() + i);
                dayString += week[d.getDay()];
            }
            let dateInfo = "";
            if (days === 1) {
                dateInfo = `${startYear}ÎÖÑ ${startMonth}Ïõî ${startDate}Ïùº ${startDay}ÏöîÏùº`;
            } else {
                const endMonth = end.getMonth() + 1;
                const endDate = end.getDate();
                const dateRange = (startMonth === endMonth)
                    ? `${startMonth}Ïõî ${startDate} ~ ${endDate}Ïùº`
                    : `${startMonth}Ïõî ${startDate}Ïùº ~ ${endMonth}Ïõî ${endDate}Ïùº`;
                dateInfo = `${startYear}ÎÖÑ ${dateRange} ${dayString}`;
            }
            return `üì¢ Ï†ïÏú° Ïπ¥ÌÜ° ÌñâÏÇ¨ (${dateInfo})`;
        }

        extractBtn.onclick = () => {
            const rows = container.querySelectorAll('.row');
            if (!rows.length) { alert("ÏÉÅÌíàÏùÑ Ï∂îÍ∞ÄÌï¥Ï£ºÏÑ∏Ïöî."); return; }
            let isValid = true;
            let resultText = getEventDateText(parseInt(dateInput.value)) + "\n\n";
            rows.forEach((row, idx) => {
                const prod = row.querySelector('.product-select').value;
                const unit = row.querySelector('.unit-select').value;
                const norm = row.querySelector('.normal-price').value;
                const sale = row.querySelector('.sale-price').value;
                if (!prod || !norm || !sale) { isValid = false; return; }
                const fmt = (n) => Number(n).toLocaleString();
                resultText += `${idx + 1}) ${prod} ${unit} ${fmt(norm)}Ïõê üëâ ${fmt(sale)}Ïõê\n`;
            });
            if (!isValid) { alert("ÏÉÅÌíàÎ™ÖÍ≥º Í∞ÄÍ≤©ÏùÑ Î™®Îëê ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî."); return; }
            resultArea.textContent = resultText.trim();
            resultArea.style.display = "block";
            copyBtn.style.display = "block";
            window.scrollTo(0, document.body.scrollHeight);
        };

        copyBtn.onclick = () => {
            const textToCopy = resultArea.textContent;
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(textToCopy).then(() => {
                    alert("Î≥µÏÇ¨ ÏôÑÎ£å!");
                }).catch(() => fallbackCopy(textToCopy));
            } else {
                fallbackCopy(textToCopy);
            }
        };

        function fallbackCopy(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";
            textArea.style.left = "-9999px";
            textArea.style.top = "0";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            textArea.setSelectionRange(0, 99999);
            try {
                document.execCommand('copy');
                alert("Î≥µÏÇ¨ ÏôÑÎ£å!");
            } catch (err) {
                alert("Î≥µÏÇ¨Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§. Í≤∞Í≥ºÏ∞ΩÏùÑ Í∏∏Í≤å ÎàåÎü¨ ÏßÅÏ†ë Î≥µÏÇ¨Ìï¥Ï£ºÏÑ∏Ïöî.");
            }
            document.body.removeChild(textArea);
        }
    </script>
</body>
</html>