<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ïπ¥ÌÜ° ÌñâÏÇ¨</title>
    <style>
        * { box-sizing: border-box; }
        body { padding: 0 15px 40px 15px; margin: 0; font-family: 'Malgun Gothic', sans-serif; background-color: #f5f5f5; }
        .main-title { text-align: center; padding: 20px 0; margin: 0 -15px 20px -15px; background: linear-gradient(135deg, #4CAF50, #2E7D32); color: white; font-size: 20px; font-weight: bold; box-shadow: 0 2px 10px rgba(0,0,0,0.1); letter-spacing: 1px; }

        /* ÏÑ§Ï†ï ÏòÅÏó≠ ÎîîÏûêÏù∏ Í∞úÏÑ† */
        .option-container { background: #fff; padding: 18px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border: 1px solid #e0e0e0; }

        .date-section { display: flex; flex-direction: column; gap: 12px; }
        .date-row { display: flex; align-items: center; justify-content: space-between; gap: 8px; }
        .date-label { font-weight: bold; font-size: 14px; color: #333; display: flex; align-items: center; gap: 5px; min-width: 80px; }
        .date-controls { display: flex; align-items: center; gap: 6px; }

        .date-btn { width: 36px; height: 36px; font-size: 18px; background-color: #f8f8f8; border: 1px solid #ddd; border-radius: 8px; cursor: pointer; color: #333; transition: background 0.2s; }
        .date-btn:active { background-color: #e0e0e0; }
        .small-input { width: 50px; height: 36px; text-align: center; font-size: 16px; border: 1px solid #ddd; border-radius: 8px; font-weight: bold; color: #2E7D32; }
        .unit-text { font-size: 14px; color: #666; min-width: 50px; }

        .no-price-mode { display: flex; align-items: center; justify-content: center; gap: 8px; border-top: 1px solid #eee; margin-top: 12px; padding-top: 12px; }
        .no-price-mode input[type="checkbox"] { width: 18px; height: 18px; accent-color: #4CAF50; }
        .no-price-mode label { font-size: 14px; font-weight: bold; color: #555; cursor: pointer; }

        /* ÌíàÎ™© Row */
        #container { display: flex; flex-direction: column; gap: 12px; margin-bottom: 25px; }
        .row { background-color: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); display: flex; flex-wrap: wrap; gap: 8px; position: relative; transition: background-color 0.3s ease; }
        .row.completed { background-color: #fff9c4; border: 1px solid #ffe082; }

        .row-header { width: 100%; display: flex; align-items: center; justify-content: space-between; margin-bottom: 5px; }
        .row-number { font-weight: bold; color: #4CAF50; font-size: 14px; }
        .manual-input-box { display: flex; align-items: center; gap: 4px; font-size: 12px; color: #666; cursor: pointer; }

        select, input { height: 45px; padding: 8px; border: 1px solid #ddd; border-radius: 6px; font-size: 15px; }
        .product-select, .product-manual { width: 100%; }
        .unit-select { flex: 1; min-width: 85px; }
        .normal-price, .sale-price { flex: 1; min-width: 95px; }

        .hide-normal-price .normal-price { display: none; }
        .controls { display: flex; gap: 4px; }
        .control-btn { padding: 6px 10px; border-radius: 6px; border: 1px solid #ddd; font-size: 14px; cursor: pointer; background: #fff; color: #333; }
        .del-btn { background-color: #ff5252; color: white; border: none; }

        .header { display: flex; gap: 10px; margin-bottom: 20px; }
        .header button { flex: 1; height: 50px; font-size: 16px; border-radius: 10px; border: none; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        #plusBtn { background-color: #4CAF50; color: white; }
        #extractBtn { background-color: #2196F3; color: white; }

        #resultArea { margin-top: 20px; padding: 15px; background-color: #fff; border: 2px dashed #4CAF50; border-radius: 10px; white-space: pre-wrap; font-size: 14px; display: none; }
        #copyBtn { background-color: #333; color: white; margin-top: 15px; width: 100%; height: 55px; display: none; border: none; border-radius: 10px; font-size: 17px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="main-title">Ïπ¥ÌÜ° ÌñâÏÇ¨</div>

    <div class="option-container">
        <div class="date-section">
            <div class="date-row">
                <span class="date-label">üìÖ ÏãúÏûëÏùº</span>
                <div class="date-controls">
                    <button class="date-btn" id="startMinus">-</button>
                    <input type="number" id="startOffset" class="small-input" value="0" min="0">
                    <button class="date-btn" id="startPlus">+</button>
                    <span class="unit-text">Ïùº ÌõÑÎ∂ÄÌÑ∞</span>
                </div>
            </div>
            <div class="date-row">
                <span class="date-label">‚è±Ô∏è Í∏∞Í∞Ñ</span>
                <div class="date-controls">
                    <button class="date-btn" id="durationMinus">-</button>
                    <input type="number" id="durationInput" class="small-input" value="1" min="1">
                    <button class="date-btn" id="durationPlus">+</button>
                    <span class="unit-text">ÏùºÍ∞Ñ ÏßÑÌñâ</span>
                </div>
            </div>
        </div>
        <div class="no-price-mode">
            <input type="checkbox" id="noNormalPrice">
            <label for="noNormalPrice">Ï†ïÏÉÅÍ∞Ä ÏÉùÎûµ Î™®Îìú (ÌåêÎß§Í∞ÄÎßå Ï∂îÏ∂ú)</label>
        </div>
    </div>

    <div id="container"></div>

    <div class="header">
        <button id="plusBtn">ÌíàÎ™© Ï∂îÍ∞Ä</button>
        <button id="extractBtn">ÌÖçÏä§Ìä∏ Ï∂îÏ∂ú</button>
    </div>

    <div id="resultArea"></div>
    <button id="copyBtn">üìã ÌÖçÏä§Ìä∏ Î≥µÏÇ¨</button>

    <script>
        const container = document.getElementById('container');
        const plusBtn = document.getElementById('plusBtn');
        const extractBtn = document.getElementById('extractBtn');
        const copyBtn = document.getElementById('copyBtn');
        const resultArea = document.getElementById('resultArea');
        const startOffsetInput = document.getElementById('startOffset');
        const durationInput = document.getElementById('durationInput');
        const noNormalPriceCheck = document.getElementById('noNormalPrice');

        const productList = [
            "ÌïúÏö∞ Í≥∞ÌÉï", "ÌïúÏö∞ Íµ≠Í±∞Î¶¨", "ÌïúÏö∞ ÍΩÉÎì±Ïã¨", "ÌïúÏö∞ Î∂àÍ≥†Í∏∞Ïö©", "ÌïúÏö∞ Ïú°Ìöå", "ÌïúÏö∞ Ïú°Ìöå(ÏÜåÏä§ Ìè¨Ìï®)", "ÌïúÏö∞ Ï±ÑÎÅùÎì±Ïã¨", "üü•üü• ÌïúÏö∞ üü•üü•",
            "1+ ÌïúÏö∞ Íµ≠Í±∞Î¶¨", "1+ ÌïúÏö∞ ÍΩÉÎì±Ïã¨", "1+ ÌïúÏö∞ Ïú°Ìöå", "1+ ÌïúÏö∞ Ïú°Ìöå(ÏÜåÏä§ Ìè¨Ìï®)", "1+ ÌïúÏö∞ Ï±ÑÎÅùÎì±Ïã¨", "üü•üü• 1+ ÌïúÏö∞ üü•üü•",
            "ÌïúÎèà Í∞àÎπÑ", "ÌïúÎèà Îì±Í∞àÎπÑ", "ÌïúÎèà Îì±Îºà", "ÌïúÎèà Î™©ÏÇ¥", "ÌïúÎèà ÏÇ¨ÌÉú", "ÌïúÎèà ÏÇºÍ≤πÏÇ¥", "ÌïúÎèà ÏïûÎã§Î¶¨ÏÇ¥(ÏàòÏú°Ïö©)", "üü•üü• ÌïúÎèà üü•üü•",
            "ÎåÄÌå®ÏÇºÍ≤πÏÇ¥(Íµ≠ÎÇ¥ÏÇ∞)", "ÎåÄÌå®ÏÇºÍ≤πÏÇ¥(ÏàòÏûÖÏÇ∞)", "ÎåÄÌå®ÏÇºÍ≤πÏÇ¥(Ïπ†Î†àÏÇ∞)", "Ïö∞ÏÇºÍ≤π(ÎØ∏Íµ≠ÏÇ∞)", "Ï∞®ÎèåÎ∞ïÏù¥(ÏàòÏûÖÏÇ∞)", "üü•üü• ÎåÄÌå®Î•ò üü•üü•",
            "ÏñëÎÖê ÎèºÏßÄÍ∞àÎπÑ", "Î∂ÅÏÑ±Î°ú Î∂àÍ≥†Í∏∞", "ÎºàÏóÜÎäî Îã≠Í∞àÎπÑ", "Í≥†Ï∂îÏû• Î∂àÍ≥†Í∏∞", "ÏñëÎÖê ÏÜåÎ∂àÍ≥†Í∏∞", "ÏñëÎÖê LAÍ∞àÎπÑ", "LAÍ∞àÎπÑÏãù ÏñëÎÖê ÎèºÏßÄÍ∞àÎπÑ", "Îã§Ìñ• ÌõàÏ†úÏò§Î¶¨", "Îã≠Î∞ú Ìé∏Ïú°", "ÏñëÎÖê Ìé∏Ïú°", "Î¨¥Îºà ÏñëÎÖêÎã≠Î∞ú", "ÌùëÎßàÎäò Ïò§Î¶¨ÌõàÏ†ú", "üü•üü• Î∞ÄÌÇ§Ìä∏ üü•üü•",
            "ÌïòÎ¶º ÏÉùÎã≠(11Ìò∏)", "ÌïòÎ¶º ÏÉùÎã≠(13Ìò∏)", "ÌïòÎ¶º ÏòÅÍ≥Ñ", "ÌïòÎ¶º ÌÜ†Ï¢ÖÎã≠", "üü•üü• Îã≠ üü•üü•"
        ];
        const unitList = ['100g', '1Ìå©', '1Î¥â(600g Ïù¥ÏÉÅ)', '1ÌÜµ', '1ÎßàÎ¶¨', '2ÎßàÎ¶¨'];

        function getCircleNum(n) {
            const circleNums = ["‚ë†","‚ë°","‚ë¢","‚ë£","‚ë§","‚ë•","‚ë¶","‚ëß","‚ë®","‚ë©","‚ë™","‚ë´","‚ë¨","‚ë≠","‚ëÆ","‚ëØ","‚ë∞","‚ë±","‚ë≤","‚ë≥","„âë","„âí","„âì","„âî","„âï","„âñ","„âó","„âò","„âô","„âö","„âõ","„âú","„âù","„âû","„âü","„ä±","„ä≤","„ä≥","„ä¥","„äµ","„ä∂","„ä∑","„ä∏","„äπ","„ä∫","„äª","„äº","„äΩ","„äæ","„äø"];
            return circleNums[n - 1] || `${n})`;
        }

        function getEventDateText(offset, duration) {
            const week = ['Ïùº', 'Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†'];
            const start = new Date();
            start.setDate(start.getDate() + offset);
            const end = new Date(start);
            end.setDate(end.getDate() + (duration - 1));
            const fmtDate = (d) => `${d.getFullYear()}ÎÖÑ ${d.getMonth() + 1}Ïõî ${d.getDate()}Ïùº (${week[d.getDay()]})`;
            const fmtShortDate = (d) => `${d.getMonth() + 1}Ïõî ${d.getDate()}Ïùº (${week[d.getDay()]})`;
            if (duration === 1) return `üì¢ Ï†ïÏú° Ïπ¥ÌÜ° ÌñâÏÇ¨ - ${fmtDate(start)}`;
            const startTxt = fmtDate(start);
            const endTxt = (start.getMonth() === end.getMonth()) ? `${end.getDate()}Ïùº (${week[end.getDay()]})` : fmtShortDate(end);
            return `üì¢ Ï†ïÏú° Ïπ¥ÌÜ° ÌñâÏÇ¨ - ${startTxt} ~ ${endTxt}`;
        }

        function updateNumbers() {
            container.querySelectorAll('.row').forEach((el, idx) => {
                el.querySelector('.row-number').textContent = `ÌíàÎ™© ${idx + 1}`;
            });
        }

        function checkCompletion(row) {
            const isNoNormal = noNormalPriceCheck.checked;
            const normVal = row.querySelector('.normal-price').value;
            const saleVal = row.querySelector('.sale-price').value;
            let isComplete = isNoNormal ? (saleVal !== "") : (normVal !== "" && saleVal !== "");
            if (isComplete) row.classList.add('completed');
            else row.classList.remove('completed');
        }

        noNormalPriceCheck.addEventListener('change', () => {
            if (noNormalPriceCheck.checked) container.classList.add('hide-normal-price');
            else container.classList.remove('hide-normal-price');
            container.querySelectorAll('.row').forEach(row => checkCompletion(row));
        });

        plusBtn.onclick = () => {
            const row = document.createElement('div');
            row.className = 'row';
            let targetItem = "ÌïúÏö∞ Íµ≠Í±∞Î¶¨";
            const lastRow = container.lastElementChild;
            if (lastRow) {
                const sel = lastRow.querySelector('.product-select');
                if(sel){
                    let lastIdx = productList.indexOf(sel.value);
                    if (lastIdx !== -1) {
                        let nextIdx = (lastIdx + 1) % productList.length;
                        while(productList[nextIdx] && productList[nextIdx].includes("üü•üü•")) {
                            nextIdx = (nextIdx + 1) % productList.length;
                        }
                        targetItem = productList[nextIdx];
                    }
                }
            }

            row.innerHTML = `
                <div class="row-header">
                    <div class="row-number-box">
                        <span class="row-number"></span>
                        <label class="manual-input-box"><input type="checkbox" class="manual-check"> ÏßÅÏ†ë ÏûÖÎ†•</label>
                    </div>
                    <div class="controls">
                        <button class="control-btn up-btn">‚Üë</button>
                        <button class="control-btn down-btn">‚Üì</button>
                        <button class="control-btn del-btn">ÏÇ≠Ï†ú</button>
                    </div>
                </div>
                <div style="width:100%" class="product-input-area">
                    <select class="product-select">
                        ${productList.map(item => `<option value="${item}" ${item.includes('üü•üü•') ? 'disabled' : ''} ${item === targetItem ? 'selected' : ''}>${item}</option>`).join('')}
                    </select>
                </div>
                <select class="unit-select">${unitList.map(u => `<option value="${u}">${u}</option>`).join('')}</select>
                <input type="number" class="normal-price" placeholder="Ï†ïÏÉÅÍ∞Ä">
                <input type="number" class="sale-price" placeholder="ÌåêÎß§Í∞Ä">
            `;

            const manualCheck = row.querySelector('.manual-check');
            const inputArea = row.querySelector('.product-input-area');
            manualCheck.onchange = () => {
                if (manualCheck.checked) inputArea.innerHTML = `<input type="text" class="product-manual" placeholder="ÏÉÅÌíàÎ™Ö ÏßÅÏ†ë ÏûÖÎ†•">`;
                else inputArea.innerHTML = `<select class="product-select">${productList.map(item => `<option value="${item}" ${item.includes('üü•üü•') ? 'disabled' : ''}>${item}</option>`).join('')}</select>`;
            };

            row.addEventListener('input', () => checkCompletion(row));
            row.querySelector('.del-btn').onclick = () => { row.remove(); updateNumbers(); };
            row.querySelector('.up-btn').onclick = () => { if (row.previousElementSibling) { container.insertBefore(row, row.previousElementSibling); updateNumbers(); } };
            row.querySelector('.down-btn').onclick = () => { if (row.nextElementSibling) { container.insertBefore(row.nextElementSibling, row); updateNumbers(); } };

            container.appendChild(row);
            updateNumbers();
            row.scrollIntoView({ behavior: 'smooth', block: 'start' });
        };

        extractBtn.onclick = () => {
            const rows = container.querySelectorAll('.row');
            if (!rows.length) return alert("ÌíàÎ™©ÏùÑ Ï∂îÍ∞ÄÌï¥Ï£ºÏÑ∏Ïöî.");
            const isNoNormal = noNormalPriceCheck.checked;
            let resultText = getEventDateText(parseInt(startOffsetInput.value), parseInt(durationInput.value)) + "\n\n";

            for (let i = 0; i < rows.length; i++) {
                const row = rows[i];
                const manualCheck = row.querySelector('.manual-check').checked;
                const prod = manualCheck ? row.querySelector('.product-manual').value : row.querySelector('.product-select').value;
                const unit = row.querySelector('.unit-select').value;
                const norm = row.querySelector('.normal-price').value;
                const sale = row.querySelector('.sale-price').value;

                if (!prod) { alert(`${i+1}Î≤à ÏÉÅÌíàÎ™ÖÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.`); return; }
                if (!isNoNormal && !norm) { alert(`${i+1}Î≤à Ï†ïÏÉÅÍ∞ÄÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.`); return; }
                if (!sale) { alert(`${i+1}Î≤à ÌåêÎß§Í∞ÄÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.`); return; }

                const fmt = (n) => Number(n).toLocaleString();
                resultText += isNoNormal ? `${getCircleNum(i + 1)} ${prod} ${unit} ${fmt(sale)}Ïõê\n` : `${getCircleNum(i + 1)} ${prod} ${unit} ${fmt(norm)}Ïõê ‚ûù ${fmt(sale)}Ïõê\n`;
            }

            resultArea.textContent = resultText.trim();
            resultArea.style.display = "block";
            copyBtn.style.display = "block";
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
        };

        copyBtn.onclick = () => {
            const text = resultArea.textContent;
            navigator.clipboard.writeText(text).then(() => alert("Î≥µÏÇ¨ ÏôÑÎ£å!")).catch(() => {
                const t = document.createElement("textarea");
                t.value = text; document.body.appendChild(t); t.select();
                document.execCommand('copy'); document.body.removeChild(t);
                alert("Î≥µÏÇ¨ ÏôÑÎ£å!");
            });
        };

        document.getElementById('startMinus').onclick = () => { if(startOffsetInput.value > 0) startOffsetInput.value--; };
        document.getElementById('startPlus').onclick = () => { startOffsetInput.value++; };
        document.getElementById('durationMinus').onclick = () => { if(durationInput.value > 1) durationInput.value--; };
        document.getElementById('durationPlus').onclick = () => { durationInput.value++; };

        window.onload = () => plusBtn.click();
    </script>
</body>
</html>