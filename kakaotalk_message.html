<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì¹´í†¡ í–‰ì‚¬</title>
    <style>
        * { box-sizing: border-box; }
        body { padding: 0 15px 40px 15px; margin: 0; font-family: 'Malgun Gothic', sans-serif; background-color: #f5f5f5; }
        .main-title { text-align: center; padding: 20px 0; margin: 0 -15px 20px -15px; background: linear-gradient(135deg, #4CAF50, #2E7D32); color: white; font-size: 20px; font-weight: bold; box-shadow: 0 2px 10px rgba(0,0,0,0.1); letter-spacing: 1px; }
        .date-controller { display: flex; align-items: center; justify-content: center; gap: 12px; background: #fff; padding: 15px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .date-controller label { font-weight: bold; font-size: 15px; margin-right: 10px; }
        .date-btn { width: 40px; height: 40px; font-size: 20px; background-color: #eee; border: 1px solid #ddd; border-radius: 8px; cursor: pointer; }
        #dateInput { width: 60px; height: 40px; text-align: center; font-size: 18px; border: 1px solid #ddd; border-radius: 8px; }

        #container { display: flex; flex-direction: column; gap: 12px; margin-bottom: 25px; }

        .header { display: flex; gap: 10px; margin-bottom: 20px; }
        .header button { flex: 1; height: 50px; font-size: 16px; border-radius: 10px; border: none; font-weight: bold; }
        #plusBtn { background-color: #4CAF50; color: white; }
        #extractBtn { background-color: #2196F3; color: white; }

        .row { background-color: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); display: flex; flex-wrap: wrap; gap: 8px; position: relative; }
        .row-number { font-weight: bold; color: #4CAF50; width: 100%; font-size: 14px; margin-bottom: 5px; }
        select, input { height: 45px; padding: 8px; border: 1px solid #ddd; border-radius: 6px; font-size: 15px; }
        .product-select { width: 100%; }
        .unit-select { flex: 1; min-width: 85px; }
        .normal-price, .sale-price { flex: 1; min-width: 95px; }

        /* ì œì–´ ë²„íŠ¼ ê·¸ë£¹ (ìœ„, ì•„ë˜, ì‚­ì œ) */
        .controls { position: absolute; top: 10px; right: 10px; display: flex; gap: 4px; }
        .control-btn { padding: 6px 10px; border-radius: 6px; border: 1px solid #ddd; font-size: 14px; cursor: pointer; background: #fff; color: #333; }
        .del-btn { background-color: #ff5252; color: white; border: none; }

        #resultArea { margin-top: 20px; padding: 15px; background-color: #fff; border: 2px dashed #4CAF50; border-radius: 10px; white-space: pre-wrap; font-size: 14px; display: none; }
        #copyBtn { background-color: #333; color: white; margin-top: 15px; width: 100%; height: 55px; display: none; border: none; border-radius: 10px; font-size: 17px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="main-title">ì¹´í†¡ í–‰ì‚¬</div>

    <div class="date-controller">
        <label>í–‰ì‚¬ ê¸°ê°„</label>
        <button class="date-btn" id="dateMinus">-</button>
        <input type="number" id="dateInput" value="1" min="1">
        <button class="date-btn" id="datePlus">+</button>
        <span>ì¼ê°„</span>
    </div>

    <div id="container"></div>

    <div class="header">
        <button id="plusBtn">í’ˆëª© ì¶”ê°€</button>
        <button id="extractBtn">í…ìŠ¤íŠ¸ ì¶”ì¶œ</button>
    </div>

    <div id="resultArea"></div>
    <button id="copyBtn">ğŸ“‹ í…ìŠ¤íŠ¸ ë³µì‚¬</button>

    <script>
        const container = document.getElementById('container');
        const plusBtn = document.getElementById('plusBtn');
        const extractBtn = document.getElementById('extractBtn');
        const copyBtn = document.getElementById('copyBtn');
        const resultArea = document.getElementById('resultArea');
        const dateInput = document.getElementById('dateInput');

        const productList = [
            "í•œìš° ê³°íƒ•", "í•œìš° êµ­ê±°ë¦¬", "í•œìš° ê½ƒë“±ì‹¬", "í•œìš° ë¶ˆê³ ê¸°ìš©", "í•œìš° ìœ¡íšŒ", "í•œìš° ìœ¡íšŒ(ì†ŒìŠ¤ í¬í•¨)", "í•œìš° ì±„ëë“±ì‹¬", "ğŸŸ¥ğŸŸ¥ í•œìš° ğŸŸ¥ğŸŸ¥",
            "1+ í•œìš° êµ­ê±°ë¦¬", "1+ í•œìš° ê½ƒë“±ì‹¬", "1+ í•œìš° ìœ¡íšŒ", "1+ í•œìš° ìœ¡íšŒ(ì†ŒìŠ¤ í¬í•¨)", "1+ í•œìš° ì±„ëë“±ì‹¬", "ğŸŸ¥ğŸŸ¥ 1+ í•œìš° ğŸŸ¥ğŸŸ¥",
            "í•œëˆ ê°ˆë¹„", "í•œëˆ ë“±ê°ˆë¹„", "í•œëˆ ë“±ë¼ˆ", "í•œëˆ ëª©ì‚´", "í•œëˆ ì‚¬íƒœ", "í•œëˆ ì‚¼ê²¹ì‚´", "í•œëˆ ì•ë‹¤ë¦¬ì‚´(ìˆ˜ìœ¡ìš©)", "ğŸŸ¥ğŸŸ¥ í•œëˆ ğŸŸ¥ğŸŸ¥",
            "ëŒ€íŒ¨ì‚¼ê²¹ì‚´(êµ­ë‚´ì‚°)", "ëŒ€íŒ¨ì‚¼ê²¹ì‚´(ìˆ˜ì…ì‚°)", "ëŒ€íŒ¨ì‚¼ê²¹ì‚´(ì¹ ë ˆì‚°)", "ìš°ì‚¼ê²¹", "ğŸŸ¥ğŸŸ¥ ëŒ€íŒ¨ë¥˜ ğŸŸ¥ğŸŸ¥",
            "ì–‘ë… ë¼ì§€ê°ˆë¹„", "ë¶ì„±ë¡œ ë¶ˆê³ ê¸°", "ë¼ˆì—†ëŠ” ë‹­ê°ˆë¹„", "ê³ ì¶”ì¥ ë¶ˆê³ ê¸°", "ì–‘ë… ì†Œë¶ˆê³ ê¸°", "ì–‘ë… LAê°ˆë¹„", "LAê°ˆë¹„ì‹ ì–‘ë… ë¼ì§€ê°ˆë¹„", "ë‹¤í–¥ í›ˆì œì˜¤ë¦¬", "ë‹­ë°œ í¸ìœ¡", "ë¬´ë¼ˆ ì–‘ë…ë‹­ë°œ", "í‘ë§ˆëŠ˜ ì˜¤ë¦¬í›ˆì œ", "ğŸŸ¥ğŸŸ¥ ë°€í‚¤íŠ¸ ğŸŸ¥ğŸŸ¥",
            "í•˜ë¦¼ ìƒë‹­(11í˜¸)", "í•˜ë¦¼ ìƒë‹­(13í˜¸)", "í•˜ë¦¼ ì˜ê³„", "í•˜ë¦¼ í† ì¢…ë‹­", "ğŸŸ¥ğŸŸ¥ ë‹­ ğŸŸ¥ğŸŸ¥"
        ];
        const unitList = ['100g', '1íŒ©', '1ë´‰(600g ì´ìƒ)', '1í†µ', '1ë§ˆë¦¬', '2ë§ˆë¦¬'];

        function getEventDateText(days) {
            const week = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
            const start = new Date();
            const end = new Date();
            end.setDate(start.getDate() + (days - 1));

            const fmtDate = (d) => `${d.getFullYear()}ë…„ ${d.getMonth() + 1}ì›” ${d.getDate()}ì¼ (${week[d.getDay()]})`;
            const fmtShortDate = (d) => `${d.getMonth() + 1}ì›” ${d.getDate()}ì¼ (${week[d.getDay()]})`;

            if (days === 1) return `ğŸ“¢ ì •ìœ¡ ì¹´í†¡ í–‰ì‚¬ - ${fmtDate(start)}`;

            const startTxt = fmtDate(start);
            const endTxt = (start.getMonth() === end.getMonth()) ? `${end.getDate()}ì¼ (${week[end.getDay()]})` : fmtShortDate(end);
            return `ğŸ“¢ ì •ìœ¡ ì¹´í†¡ í–‰ì‚¬ - ${startTxt} ~ ${endTxt}`;
        }

        function updateNumbers() {
            container.querySelectorAll('.row').forEach((el, idx) => {
                el.querySelector('.row-number').textContent = `í’ˆëª© ${idx + 1}`;
            });
        }

        plusBtn.onclick = () => {
            const row = document.createElement('div');
            row.className = 'row';

            // ì„ íƒ ë¡œì§: ì²« í’ˆëª©ì€ í•œìš° êµ­ê±°ë¦¬, ê·¸ ë’¤ë¡  ë‹¤ìŒ í•­ëª©
            let targetItem = "í•œìš° êµ­ê±°ë¦¬";
            const lastRow = container.lastElementChild;

            if (lastRow) {
                const lastVal = lastRow.querySelector('.product-select').value;
                let lastIdx = productList.indexOf(lastVal);
                let nextIdx = (lastIdx + 1) % productList.length;
                // êµ¬ë¶„ì„ ì€ ê±´ë„ˆëœ€
                while(productList[nextIdx] && productList[nextIdx].includes("ğŸŸ¥ğŸŸ¥")) {
                    nextIdx = (nextIdx + 1) % productList.length;
                }
                targetItem = productList[nextIdx];
            }

            row.innerHTML = `
                <div class="row-number"></div>
                <div class="controls">
                    <button class="control-btn up-btn">â†‘</button>
                    <button class="control-btn down-btn">â†“</button>
                    <button class="control-btn del-btn">ì‚­ì œ</button>
                </div>
                <select class="product-select">
                    ${productList.map(item => `<option value="${item}" ${item.includes('ğŸŸ¥ğŸŸ¥') ? 'disabled' : ''} ${item === targetItem ? 'selected' : ''}>${item}</option>`).join('')}
                </select>
                <select class="unit-select">${unitList.map(u => `<option value="${u}">${u}</option>`).join('')}</select>
                <input type="number" class="normal-price" placeholder="ì •ìƒê°€">
                <input type="number" class="sale-price" placeholder="íŒë§¤ê°€">
            `;

            // ì´ë²¤íŠ¸ ë°”ì¸ë”©
            row.querySelector('.del-btn').onclick = () => { row.remove(); updateNumbers(); };
            row.querySelector('.up-btn').onclick = () => {
                if (row.previousElementSibling) {
                    container.insertBefore(row, row.previousElementSibling);
                    updateNumbers();
                }
            };
            row.querySelector('.down-btn').onclick = () => {
                if (row.nextElementSibling) {
                    container.insertBefore(row.nextElementSibling, row);
                    updateNumbers();
                }
            };

            container.appendChild(row);
            updateNumbers();
            row.scrollIntoView({ behavior: 'smooth', block: 'start' });
        };

        extractBtn.onclick = () => {
            const rows = container.querySelectorAll('.row');
            if (!rows.length) return alert("í’ˆëª©ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”.");
            let resultText = getEventDateText(parseInt(dateInput.value)) + "\n\n";
            rows.forEach((row, idx) => {
                const prod = row.querySelector('.product-select').value;
                const unit = row.querySelector('.unit-select').value;
                const norm = row.querySelector('.normal-price').value || 0;
                const sale = row.querySelector('.sale-price').value || 0;
                const fmt = (n) => Number(n).toLocaleString();
                resultText += `${idx + 1}) ${prod} ${unit} ${fmt(norm)}ì› ğŸ‘‰ ${fmt(sale)}ì›\n`;
            });
            resultArea.textContent = resultText.trim();
            resultArea.style.display = "block";
            copyBtn.style.display = "block";
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
        };

        copyBtn.onclick = () => {
            const text = resultArea.textContent;
            navigator.clipboard.writeText(text).then(() => alert("ë³µì‚¬ ì™„ë£Œ!"))
            .catch(() => {
                const t = document.createElement("textarea");
                t.value = text; document.body.appendChild(t); t.select();
                document.execCommand('copy'); document.body.removeChild(t);
                alert("ë³µì‚¬ ì™„ë£Œ!");
            });
        };

        document.getElementById('dateMinus').onclick = () => { if(dateInput.value > 1) dateInput.value--; };
        document.getElementById('datePlus').onclick = () => { dateInput.value++; };

        // ì‹œì‘ ì‹œ í’ˆëª© í•˜ë‚˜ ì¶”ê°€
        window.onload = () => plusBtn.click();
    </script>
</body>
</html>
